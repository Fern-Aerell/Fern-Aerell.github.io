const output=document.getElementById("output"),buttons={clear:document.getElementById("button_clear"),delete:document.getElementById("button_delete"),equal:document.getElementById("button_equal"),comma:document.getElementById("button_coma"),percent:document.getElementById("button_percen"),positiveNegative:document.getElementById("button_positive_negative"),operators:{div:document.getElementById("button_div"),mul:document.getElementById("button_mul"),sub:document.getElementById("button_sub"),add:document.getElementById("button_add")},numbers:Array.from({length:10},((e,t)=>document.getElementById(`button_${t}`)))},operators=["÷","x","-","+"];function clear(){output.innerText="0"}function recoveryFromError(){["-∞","∞","kesalahan"].includes(output.innerText.toLowerCase())&&clear()}function del(){recoveryFromError();-1==output.innerText.search("\\(-[0-9]+\\)$")?output.innerText=output.innerText.slice(0,-1)||0:toggleSign()}function insertNumber(e){if(recoveryFromError(),-1==output.innerText.search("%$")&&-1==output.innerText.search("\\)$"))return output.innerText.endsWith(",0")?(output.innerText=output.innerText.slice(0,-1),void(output.innerText+=e)):void(output.innerText="0"===output.innerText?e:output.innerText+e)}function insertComma(){recoveryFromError(),-1==output.innerText.search("[0-9]+,[0-9]+$")&&-1!=output.innerText.search("[0-9]+$")&&(output.innerText+=",0")}function insertOperator(e){recoveryFromError(),operators.includes(output.innerText.slice(-1))&&del(),output.innerText+=e}function calculate(){recoveryFromError(),"20112005"!=output.innerText?output.innerText.length>0&&(output.innerText=evaluation(output.innerText)):output.innerText="Fern Aerell"}function insertPercent(){recoveryFromError(),output.innerText.length>0&&-1==output.innerText.search("([0-9]+|[0-9]+,[0-9]+)%$")&&(output.innerText+="%")}function toggleSign(){if(recoveryFromError(),0==output.innerText)return;const e=output.innerText.search("([0-9]+|[0-9]+,[0-9]+)$");if(-1!=e)return void(output.innerText=output.innerText.slice(0,e)+"(-"+output.innerText.slice(e)+")");const t=output.innerText.search("\\(-([0-9]+|[0-9]+,[0-9]+)\\)$");-1==t||(output.innerText=output.innerText.slice(0,t)+output.innerText.slice(t).substring(2,output.innerText.slice(t).length-1))}function evaluation(expression){try{return String(eval(expression.replaceAll("%","/100").replaceAll("÷","/").replaceAll("x","*").replaceAll(",",".").replaceAll("Fern Aerell","20112005"))).replaceAll(".",",").replaceAll("Infinity","∞").replaceAll("NaN","Kesalahan")}catch{return expression}}document.addEventListener("keydown",(function(e){if(-1!=e.key.search("^[0-9]$"))return e.preventDefault(),void insertNumber(e.key);if(e.ctrlKey&&"-"==e.key)return e.preventDefault(),void toggleSign();if(e.shiftKey&&["+","*"].includes(e.key)||["+","*","-","x","/","÷"].includes(e.key)){e.preventDefault();let t=e.key;return"*"==t?t="x":"/"==t&&(t="÷"),void insertOperator(t)}return"%"==e.key?(e.preventDefault(),void insertPercent()):[",","."].includes(e.key)?(e.preventDefault(),void insertComma()):["=","Enter"].includes(e.key)?(e.preventDefault(),void calculate()):["Delete","Backspace","Escape"].includes(e.key)?(e.preventDefault(),void(e.ctrlKey||"Escape"==e.key?clear():del())):void 0})),buttons.clear.addEventListener("click",(()=>clear())),buttons.delete.addEventListener("click",(()=>del())),buttons.equal.addEventListener("click",(()=>calculate())),buttons.comma.addEventListener("click",(()=>insertComma())),buttons.percent.addEventListener("click",(()=>insertPercent())),buttons.positiveNegative.addEventListener("click",(()=>toggleSign())),buttons.numbers.forEach(((e,t)=>e.addEventListener("click",(()=>insertNumber(t))))),Object.values(buttons.operators).forEach(((e,t)=>e.addEventListener("click",(()=>insertOperator(operators[t])))));